configfile: 'config/config_PBMC.yaml'

SAMPLES = range(1, 33)

rule download_annotations:
    output:
        'resources/gencode.v44.basic.annotation.gtf.gz'
    shell:
        'wget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_44/gencode.v44.basic.annotation.gtf.gz '
        '-P resources/'

rule find_enhancer_pairs:
    input:
        expand('results/SCENT_outputs/SCENT_output_{sample}.csv', sample=SAMPLES)
    output:
        'results/SCENT_peak_gene/significant_peak_gene_associations.csv',
        expand('results/enhancer_pairs/enhancer_pairs_{sample}.csv', sample=SAMPLES),
        'results/SCENT_peak_gene/SCENT_gene_set.csv'
    conda:
        'envs/pandas.yaml'
    script:
        'scripts/find_enhancer_pairs.py'